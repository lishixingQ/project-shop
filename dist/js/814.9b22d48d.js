"use strict";(self["webpackChunkproject_shop"]=self["webpackChunkproject_shop"]||[]).push([[814],{3814:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("商品管理")]),t("el-breadcrumb-item",[e._v("商品分类")])],1),t("el-card",{staticClass:"box-card"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addClassify}},[e._v("添加分类")]),t("tree-table",{staticClass:"treeTable",attrs:{data:e.cateListData,columns:e.columns,"show-index":"","selection-type":!1,"expand-type":!1,"index-text":"#",border:"","show-row-hover":!1},scopedSlots:e._u([{key:"isOk",fn:function(e){return[!1===e.row.cat_deleted?t("i",{staticClass:"el-icon-success",staticStyle:{color:"forestgreen"}}):t("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})]}},{key:"level",fn:function(a){return[0==a.row.cat_level?t("el-tag",{attrs:{size:"mini"}},[e._v("一级")]):1==a.row.cat_level?t("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("二级")]):t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v("三级")])]}},{key:"action",fn:function(a){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.editCate(a.row.cat_id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.deleteCate(a.row.cat_id)}}},[e._v("删除")])]}}])}),t("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[3,5,10,15],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"添加分类",visible:e.addDialog,width:"30%"},on:{"update:visible":function(t){e.addDialog=t},close:e.addDialogClosed}},[t("el-form",{ref:"addClassifyRef",attrs:{model:e.addClassifyForm,rules:e.addClassifyrules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称：",prop:"cat_name"}},[t("el-input",{model:{value:e.addClassifyForm.cat_name,callback:function(t){e.$set(e.addClassifyForm,"cat_name",t)},expression:"addClassifyForm.cat_name"}})],1),t("el-form-item",{attrs:{label:"父级分类："}},[t("el-cascader",{attrs:{options:e.parentCateList,props:e.parentCateListProps,clearable:""},on:{change:e.handleChange},model:{value:e.selectedKeys,callback:function(t){e.selectedKeys=t},expression:"selectedKeys"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddCate}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"修改分类",visible:e.setDialog,width:"30%"},on:{"update:visible":function(t){e.setDialog=t}}},[t("el-form",{ref:"setClassifyRef",attrs:{model:e.setClassifyForm,rules:e.setClassifyRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"分类名称",prop:"cat_name"}},[t("el-input",{model:{value:e.setClassifyForm.cat_name,callback:function(t){e.$set(e.setClassifyForm,"cat_name",t)},expression:"setClassifyForm.cat_name"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.setDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmSetCate}},[e._v("确 定")])],1)],1)],1)},i=[],r={props:{},data(){return{queryInfo:{type:3,pagenum:1,pagesize:5},cateListData:[],total:0,columns:[{label:"分类名称",prop:"cat_name",minWidth:"210px"},{label:"是否有效",type:"template",template:"isOk",minWidth:"200px"},{label:"排序",type:"template",template:"level",minWidth:"200px"},{label:"操作",type:"template",template:"action",minWidth:"200px"}],addDialog:!1,addClassifyForm:{cat_name:"",cat_pid:0,cat_level:0},addClassifyrules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},parentCateList:[],selectedKeys:[],parentCateListProps:{expandTrigger:"hover",value:"cat_id",label:"cat_name",children:"children",checkStrictly:!0},setDialog:!1,setClassifyForm:{},setClassifyRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}}},methods:{async getCateListData(){const{data:e}=await this.$axios.get("categories",{params:this.queryInfo});if(200!=e.meta.status)return this.$message.error("获取商品分类列表数据失败！");this.getParentCateList(),this.cateListData=e.data.result,this.total=e.data.total},handleSizeChange(e){this.queryInfo.pagesize=e,this.getCateListData()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getCateListData()},async addClassify(){this.addDialog=!0},addDialogClosed(){this.$refs.addClassifyRef.resetFields(),this.selectedKeys=[],this.addClassifyForm.cat_pid=0,this.addClassifyForm.cat_level=0},handleChange(){this.selectedKeys.length>0?(this.addClassifyForm.cat_pid=this.selectedKeys[this.selectedKeys.length-1],this.addClassifyForm.cat_level=this.selectedKeys.length):(this.addClassifyForm.cat_pid=0,this.addClassifyForm.cat_level=0)},async getParentCateList(){const{data:e}=await this.$axios.get("categories",{params:{type:2}});if(200!=e.meta.status)return this.$message.error("获取父级分类列表失败！");this.parentCateList=e.data},confirmAddCate(){this.$refs.addClassifyRef.validate((async e=>{if(!e)return this.$message.error("请输入分类名称！");{const{data:e}=await this.$axios.post("categories",this.addClassifyForm);if(201!=e.meta.status)return this.addDialog=!1,this.$message.error("添加分类失败！");this.$message.success("添加分类成功！"),this.getCateListData(),this.addDialog=!1}}))},async editCate(e){this.setDialog=!0;const{data:t}=await this.$axios.get(`categories/${e}`);if(200!=t.meta.status)return this.$message.error("获取分类名称失败！");this.$message.success("获取分类名称成功！"),this.setClassifyForm=t.data},confirmSetCate(){this.$refs.setClassifyRef.validate((async e=>{if(!e)return this.$message.error("请输入正确的分类名称！");const{data:t}=await this.$axios.put(`categories/${this.setClassifyForm.cat_id}`,{cat_name:this.setClassifyForm.cat_name});if(200!=t.meta.status)return this.$message.error("修改分类失败！");this.$message.success("修改分类成功！"),this.getCateListData(),this.setDialog=!1}))},async deleteCate(e){const t=await this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("cancel"==t)this.$message("已取消删除！");else{const{data:t}=await this.$axios.delete(`categories/${e}`);if(200!=t.meta.status)return this.$message.error("删除分类失败！");this.$message.success("删除分类成功！"),this.getCateListData()}}},mounted(){this.getCateListData()},components:{}},l=r,o=a(1001),n=(0,o.Z)(l,s,i,!1,null,"268c0dbe",null),c=n.exports}}]);
//# sourceMappingURL=814.9b22d48d.js.map